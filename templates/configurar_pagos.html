{% extends "base.html" %}

{% block title %}Configuración de Pagos{% endblock %}

{% block content %}
<div class="configuracion-pagos-container"
    style="width: 80%; margin: auto; padding: 20px; border: 1px solid #dddddd3b; border-radius: 8px; background-color: #f9f9f93a; margin-top: 50px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);">

    <div class="agregar-cripta-container"
        style="width: 70%; margin: auto; margin-top: 50px;">
        <h3
            style="font-size: 1.8em; color: #333; text-align: center; margin-bottom: 20px;">Agregar
            Cripta y Saldo</h3>
        <form action="{{ url_for('agregar_cripta') }}" method="post"
            style="width: 100%;">
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="cripta"
                    style="display: block; margin-bottom: 5px; font-weight: bold;">Cripta:</label>
                <input type="text" id="cripta" name="cripta" required
                    style="width: calc(100% - 12px); padding: 8px; margin-bottom: 10px; border: 1px solid #cccccc42; border-radius: 4px; font-size: 16px;">
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="saldo"
                    style="display: block; margin-bottom: 5px; font-weight: bold;">Saldo:</label>
                <input type="number" step="0.01" id="saldo" name="saldo"
                    required
                    style="width: calc(100% - 12px); padding: 8px; margin-bottom: 10px; border: 1px solid #cccccc3d; border-radius: 4px; font-size: 16px;">
            </div>
            <div class="form-group">
                <button type="submit"
                    style="background-color: #04AA6D; color: rgba(255, 255, 255, 0.863); border: none; padding: 10px 20px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; cursor: pointer; border-radius: 4px;">Agregar
                    Cripta</button>
            </div>
        </form>
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <ul class="flashes">
            {% for message in messages %}
            <li>{{ message }}</li>
            {% endfor %}
        </ul>
        {% endif %}
        {% endwith %}
    </div>

    <!-- Agregar sección para sumar a todos los saldos -->
    
    <div class="sumar-saldos-container" style="width: 70%; margin: auto; margin-top: 50px;">
        <h3 style="font-size: 1.8em; color: #333; text-align: center; margin-bottom: 20px;">Sumar a los Saldos</h3>
        <form action="{{ url_for('sumar_saldos') }}" method="post" style="width: 100%;">
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="monto_sumar" style="display: block; margin-bottom: 5px; font-weight: bold;">Monto a Sumar:</label>
                <input type="number" step="0.01" id="monto_sumar" name="monto_sumar" required style="width: calc(100% - 12px); padding: 8px; margin-bottom: 10px; border: 1px solid #cccccc6e; border-radius: 4px; font-size: 16px;">
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display: block; margin-bottom: 5px; font-weight: bold;">Opciones:</label><br>
                <input type="radio" id="todas_criptas" name="opcion" value="todas" checked>
                <label for="todas_criptas">A todas las criptas</label><br>
                <input type="radio" id="una_cripta" name="opcion" value="una">
                <label for="una_cripta">A una cripta específica</label><br>
            </div>
            <div id="cripta_especifica" style="display: none;">
                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="cripta" style="display: block; margin-bottom: 5px; font-weight: bold;">Cripta:</label>
                    <input type="text" id="cripta" name="cripta" style="width: calc(100% - 12px); padding: 8px; border: 1px solid #cccccc6e; border-radius: 4px; font-size: 16px;">
                </div>
            </div>
            <div class="form-group" style="margin-bottom: 20px;">
                <label for="motivo" style="display: block; margin-bottom: 5px; font-weight: bold;">Motivo:</label>
                <textarea id="motivo" name="motivo" rows="3" required style="width: calc(100% - 12px); padding: 8px; border: 1px solid #cccccc6e; border-radius: 4px; font-size: 16px;"></textarea>
            </div>
            <button type="submit" class="btn btn-primary" style="padding: 8px 20px; background-color: #007bff; color: #fff; border: none; border-radius: 4px; cursor: pointer;">Sumar Saldos</button>
        </form>
    </div>

    {% if historico %}
    <div class="historico-container" style="margin-top: 50px;">
        <h3 style="font-size: 1.8em; color: #333; text-align: center; margin-bottom: 20px;">Historial de Cargos</h3>
        <table style="width: 100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="border: 1px solid #cccccc3d; padding: 8px; background-color: #f2f2f25b;">Monto</th>
                    <th style="border: 1px solid #cccccc3d; padding: 8px; background-color: #f2f2f25b;">Fecha</th>
                    <th style="border: 1px solid #cccccc3d; padding: 8px; background-color: #f2f2f25b;">Motivo</th>
                </tr>
            </thead>
            <tbody>
                {% for cargo in historico %}
                <tr>
                    <td style="border: 1px solid #cccccc3d; padding: 8px;">{{ cargo.monto }}</td>
                    <td style="border: 1px solid #cccccc3d; padding: 8px;">{{ cargo.fecha }}</td>
                    <td style="border: 1px solid #cccccc3d; padding: 8px;">{{ cargo.motivo }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}
</div>

<script>
    // Mostrar u ocultar el campo de cripta específica según la selección
    document.querySelectorAll('input[name="opcion"]').forEach(function(elem) {
        elem.addEventListener('change', function() {
            if (this.value === 'una') {
                document.getElementById('cripta_especifica').style.display = 'block';
            } else {
                document.getElementById('cripta_especifica').style.display = 'none';
            }
        });
    });
</script>


{% endblock %}